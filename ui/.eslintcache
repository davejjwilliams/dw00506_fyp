[{"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\index.js":"1","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\reportWebVitals.js":"2","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\App.js":"3","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\layout\\Navbar.js":"4","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\Home.js":"5","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\About.js":"6","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\ProductState.js":"7","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\productReducer.js":"8","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\productContext.js":"9","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\types.js":"10","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\Products.js":"11","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\ProductItem.js":"12","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\NewProduct.js":"13","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\auth\\Register.js":"14","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\AuthState.js":"15","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\authReducer.js":"16","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\authContext.js":"17","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\auth\\Login.js":"18","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\utils\\setAuthToken.js":"19","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\routing\\PrivateRoute.js":"20","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\Code.js":"21","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\Product.js":"22","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\Messages.js":"23","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\MessageItem.js":"24","C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\NewMessage.js":"25"},{"size":478,"mtime":1612354783535,"results":"26","hashOfConfig":"27"},{"size":362,"mtime":499162500000,"results":"28","hashOfConfig":"27"},{"size":2039,"mtime":1618433234101,"results":"29","hashOfConfig":"27"},{"size":2599,"mtime":1619272096719,"results":"30","hashOfConfig":"27"},{"size":912,"mtime":1619272136920,"results":"31","hashOfConfig":"27"},{"size":1868,"mtime":1620235648789,"results":"32","hashOfConfig":"27"},{"size":3655,"mtime":1620246691231,"results":"33","hashOfConfig":"27"},{"size":1395,"mtime":1620304239225,"results":"34","hashOfConfig":"27"},{"size":117,"mtime":1612370659480,"results":"35","hashOfConfig":"27"},{"size":867,"mtime":1618757977755,"results":"36","hashOfConfig":"27"},{"size":743,"mtime":1621119474715,"results":"37","hashOfConfig":"27"},{"size":1068,"mtime":1619272840296,"results":"38","hashOfConfig":"27"},{"size":4435,"mtime":1621089452214,"results":"39","hashOfConfig":"27"},{"size":4741,"mtime":1619275575236,"results":"40","hashOfConfig":"27"},{"size":2397,"mtime":1612905838508,"results":"41","hashOfConfig":"27"},{"size":1097,"mtime":1612456446157,"results":"42","hashOfConfig":"27"},{"size":111,"mtime":1612389875305,"results":"43","hashOfConfig":"27"},{"size":2036,"mtime":1619275588310,"results":"44","hashOfConfig":"27"},{"size":251,"mtime":1612445663119,"results":"45","hashOfConfig":"27"},{"size":586,"mtime":1612618332087,"results":"46","hashOfConfig":"27"},{"size":2311,"mtime":1619274335206,"results":"47","hashOfConfig":"27"},{"size":2097,"mtime":1619300625753,"results":"48","hashOfConfig":"27"},{"size":547,"mtime":1619271775119,"results":"49","hashOfConfig":"27"},{"size":2520,"mtime":1619274290647,"results":"50","hashOfConfig":"27"},{"size":5100,"mtime":1621092466467,"results":"51","hashOfConfig":"27"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},"1e4o0e3",{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"63","messages":"64","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"69","messages":"70","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"71","messages":"72","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"73","messages":"74","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"75","messages":"76","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"81","messages":"82","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"83","messages":"84","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"85","messages":"86","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"87","messages":"88","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"89","messages":"90","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"91","messages":"92","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"93","messages":"94","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"95","messages":"96","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"101"},{"filePath":"102","messages":"103","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"104","usedDeprecatedRules":"54"},"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\index.js",[],["105","106"],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\reportWebVitals.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\App.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\layout\\Navbar.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\Home.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\About.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\ProductState.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\productReducer.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\product\\productContext.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\types.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\Products.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\ProductItem.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\NewProduct.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\auth\\Register.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\AuthState.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\authReducer.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\context\\auth\\authContext.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\auth\\Login.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\utils\\setAuthToken.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\routing\\PrivateRoute.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\pages\\Code.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\products\\Product.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\Messages.js",[],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\MessageItem.js",[],["107","108"],"C:\\Users\\Dave\\ethereumworkspace\\dw00506_fyp\\ui\\src\\components\\messages\\NewMessage.js",["109"],"import React, { Fragment, useState, useContext, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport AuthContext from '../../context/auth/authContext';\r\nimport ProductContext from '../../context/product/productContext';\r\nimport { KEYUTIL, KJUR } from 'jsrsasign';\r\n\r\nimport M from 'materialize-css/dist/js/materialize.min.js';\r\n\r\nconst NewMessage = props => {\r\n  const authContext = useContext(AuthContext);\r\n  const { user, loadUser } = authContext;\r\n\r\n  const productContext = useContext(ProductContext);\r\n  const {\r\n    product,\r\n    formSuccess,\r\n    error,\r\n    submitMessage,\r\n    getProduct,\r\n    resetFormSuccess,\r\n    clearProductErrors\r\n  } = productContext;\r\n\r\n  useEffect(() => {\r\n    loadUser();\r\n    getProduct(props.match.params.id);\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (formSuccess) {\r\n      resetFormSuccess();\r\n      props.history.push(`/product/${props.match.params.id}`);\r\n    }\r\n\r\n    if (error === 'Customer is not authorized to create messages') {\r\n      M.toast({ html: 'You cannot create a message as a customer.' });\r\n      clearProductErrors();\r\n    }\r\n    if (error === 'User is not authorised to create product messages.') {\r\n      M.toast({\r\n        html: 'You are not authorised to create updates for this product.'\r\n      });\r\n      clearProductErrors();\r\n    }\r\n    if (error === 'Signature is not valid.') {\r\n      M.toast({ html: 'The signature is not valid.' });\r\n      clearProductErrors();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [formSuccess, error]);\r\n\r\n  const [messageFields, setMessageFields] = useState({\r\n    content: '',\r\n    privKey: ''\r\n  });\r\n\r\n  const [signature, setSignature] = useState('');\r\n  const [signedMessage, setSignedMessage] = useState('');\r\n\r\n  const { content, privKey } = messageFields;\r\n\r\n  const signMessage = () => {\r\n    try {\r\n      var today = new Date();\r\n      today =\r\n        today.getUTCDate() +\r\n        '/' +\r\n        (today.getUTCMonth() + 1) +\r\n        '/' +\r\n        today.getUTCFullYear();\r\n\r\n      var priv = KEYUTIL.getKey(privKey);\r\n      var sig = new KJUR.crypto.Signature({ alg: 'SHA512withECDSA' });\r\n      sig.init(priv);\r\n\r\n      // append today's date in the form dd/mm/yyyy\r\n      var toSign = today + '-' + content;\r\n      sig.updateString(toSign);\r\n\r\n      var sigHex = sig.sign();\r\n      setSignature(sigHex);\r\n      setSignedMessage(toSign);\r\n    } catch (err) {\r\n      M.toast({\r\n        html: 'Something went wrong while signing. Please check each field again.'\r\n      });\r\n    }\r\n  };\r\n\r\n  const onChange = e => {\r\n    setMessageFields({ ...messageFields, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const onSubmit = e => {\r\n    e.preventDefault();\r\n    if (content === '' || privKey === '' || signature === '') {\r\n      M.toast({ html: 'Please fill in all fields and sign your message.' });\r\n    } else {\r\n      // props.history.push(`/product/${props.match.params.id}`);\r\n      submitMessage({\r\n        product_id: product._id,\r\n        content,\r\n        public_key: user.public_key.replace(new RegExp('\\r\\n', 'g'), ''),\r\n        signature\r\n      });\r\n    }\r\n  };\r\n\r\n  var today = new Date();\r\n  var dd = String(today.getDate()).padStart(2, '0');\r\n  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n  var yyyy = today.getFullYear();\r\n  today = dd + '/' + mm + '/' + yyyy;\r\n\r\n  return (\r\n    <Fragment>\r\n      <br />\r\n      <Link\r\n        to={`/product/${props.match.params.id}`}\r\n        className='btn btn-small blue darken-4'\r\n      >\r\n        <i className='material-icons'>arrow_back</i>\r\n      </Link>\r\n      <h2>New Update for {product && product.name}</h2>\r\n      <h4>Enter the product update below.</h4>\r\n      <br />\r\n      <form onSubmit={onSubmit}>\r\n        <div className='input-field'>\r\n          <label className='active' htmlFor='content'>\r\n            Message\r\n          </label>\r\n          <textarea\r\n            name='content'\r\n            value={content}\r\n            onChange={onChange}\r\n            className='materialize-textarea'\r\n          />\r\n        </div>\r\n        <div className='input-field'>\r\n          <label className='active' htmlFor='privKey'>\r\n            Private Key PEM\r\n          </label>\r\n          <textarea\r\n            name='privKey'\r\n            value={privKey}\r\n            onChange={onChange}\r\n            className='materialize-textarea'\r\n          />\r\n        </div>\r\n        <h4>Signature</h4>\r\n        <a href='#!' className='btn blue darken-4' onClick={signMessage}>\r\n          Sign Message\r\n        </a>\r\n        {signature !== '' && (\r\n          <Fragment>\r\n            <br />\r\n            <br />\r\n            <p style={{ overflowWrap: 'break-word' }}>\r\n              Signed Content: \"{signedMessage}\"\r\n            </p>\r\n            <p style={{ overflowWrap: 'break-word' }}>Signature: {signature}</p>\r\n            <input\r\n              type='submit'\r\n              value='Submit'\r\n              className='btn btn-large green'\r\n            />\r\n          </Fragment>\r\n        )}\r\n      </form>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default NewMessage;\r\n",{"ruleId":"110","replacedBy":"111"},{"ruleId":"112","replacedBy":"113"},{"ruleId":"110","replacedBy":"114"},{"ruleId":"112","replacedBy":"115"},{"ruleId":"116","severity":1,"message":"117","line":104,"column":56,"nodeType":"118","messageId":"119","endLine":104,"endColumn":62},"no-native-reassign",["120"],"no-negated-in-lhs",["121"],["120"],["121"],"no-control-regex","Unexpected control character(s) in regular expression: \\x0d, \\x0a.","Literal","unexpected","no-global-assign","no-unsafe-negation"]